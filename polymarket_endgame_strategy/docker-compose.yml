# Polymarket 尾盘交易策略 Docker Compose 配置
# 
# 使用方法:
#   docker-compose up -d              # 启动服务（后台运行）
#   docker-compose logs -f            # 查看日志
#   docker-compose down               # 停止服务
#   docker-compose up -d --build      # 重新构建并启动

version: '3.8'

services:
  polymarket-strategy:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: polymarket-endgame-strategy
    restart: unless-stopped
    
    # 环境变量配置（推荐使用 .env 文件）
    env_file:
      - .env
    
    # 也可以直接设置环境变量
    environment:
      - TZ=UTC
      # 交易参数（可选，覆盖默认值）
      - ENTRY_PRICE=0.95
      - EXIT_PRICE=0.99
      - MIN_TIME_TO_END=5
      - MAX_TIME_TO_END=15
      - MAX_POSITION_SIZE=100
      - MAX_TOTAL_EXPOSURE=500
      - SCAN_INTERVAL=10
    
    # 运行命令
    # 修改为实际运行模式时，移除 --dry-run
    command: ["--dry-run"]
    
    # 日志配置
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
    
    # 挂载卷（可选：持久化日志）
    volumes:
      - ./logs:/app/logs:rw
    
    # 资源限制（可选）
    deploy:
      resources:
        limits:
          cpus: '0.5'
          memory: 512M
        reservations:
          cpus: '0.1'
          memory: 128M

  # 可选：使用 Redis 做缓存和状态存储
  # redis:
  #   image: redis:7-alpine
  #   container_name: polymarket-redis
  #   restart: unless-stopped
  #   volumes:
  #     - redis_data:/data

# 可选卷定义
# volumes:
#   redis_data:

networks:
  default:
    name: polymarket-network
